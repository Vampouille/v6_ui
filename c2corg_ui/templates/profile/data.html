<%!
    from c2corg_ui.templates.utils import get_lang_lists
    from json import dumps
%>
<%namespace file="../helpers/view.html" import="get_image_gallery, get_document_description, show_areas, get_licence"/>
<%namespace file="helpers/view.html" import="get_profile_general"/>

% if not_authorized:
  <div class="view-details-not-authorised text-center">
    <span class="lead">
      <div id="document-description" class="collapse in" translate>This profile is only available to authenticated users.</div>
    </span>
  </div>

% else:
          % if geometry:

        % if profile.get('areas'):
        <article class="location-static">
          ${show_areas(profile)}
        </article>
        % endif
        % endif
  <div class="row">
    <div class="col-xs-12 col-md-4 col-lg-3">

      <div app-view-details>
        % if geometry:

    
        <div ng-init='profileFeature = {
                      "type": "FeatureCollection",
                      "properties": {},
                      "features": [{
                      "type": "Feature",
                      "geometry": {"type": "Point", "coordinates": [${geometry.x}, ${geometry.y}]},
                      "properties": {
                      "title": ${dumps(profile["name"]) | n},
                      "lang": "${locale["lang"]}",
                      "documentId": ${profile['document_id']},
                                                           "module": "profiles",
                                                           "highlight": true
                                                           }
                                                           }]
                                                           };'></div>
        <app-map class="view-details-map" app-map-feature-collection="profileFeature"></app-map>
        % endif
        <div ng-init="detailsCtrl.documentService.setAssociations(${profile['associations']});"></div>

        ${get_image_gallery()}


   
    
            ${get_profile_general(profile)}
            ${get_licence(profile)}
      
   

        ${get_document_description(locale, 'profile')}



      </div>

    </div>

    <div clas="col-xs-12 col-md-8 col-lg-3">
      <app-feed app-feed-profile="${profile['document_id']}" id="feed"></app-feed>
    </div>
  </div>
% endif
